<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <script>
        // Redirect standalone lifestyle assessment to SPA route
        if (window.location.pathname.includes('lifestyle Assessment')) {
            window.location.href = 'index.html#/screening/step2';
        }
    </script>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>OncoGuard AI - Step 2: Lifestyle Assessment</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: { "primary": "#137fec", "background-light": "#f6f7f8", "background-dark": "#101922" },
                    fontFamily: { "display": ["Inter"] },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
                },
            },
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100dvh;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(8px)
            }

            to {
                opacity: 1;
                transform: translateY(0)
            }
        }

        .fade-in {
            animation: fadeIn 0.4s ease forwards;
        }

        input[type='range']::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 22px;
            height: 22px;
            background: #137fec;
            cursor: pointer;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 1px 4px rgba(0, 0, 0, .2);
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark font-display text-slate-900 dark:text-slate-100 min-h-screen flex flex-col">
    <script src="js/auth.js"></script>
    <script>requireAuth();</script>

    <!-- Header -->
    <header
        class="sticky top-0 z-10 bg-white/90 dark:bg-slate-900/90 backdrop-blur-md border-b border-slate-200 dark:border-slate-800">
        <div class="max-w-2xl mx-auto flex items-center justify-between p-4">
            <a href="screeing step1.html"
                class="flex items-center gap-2 text-primary hover:underline text-sm font-semibold">
                <span class="material-symbols-outlined text-lg">arrow_back</span> Back
            </a>
            <h1 class="text-lg font-bold tracking-tight">Lifestyle Assessment</h1>
            <button onclick="logout()"
                class="text-xs text-slate-400 hover:text-red-500 transition-colors flex items-center gap-1">
                <span class="material-symbols-outlined text-sm">logout</span>
            </button>
        </div>
    </header>

    <!-- Progress -->
    <div class="max-w-2xl mx-auto w-full px-4 pt-6 pb-2">
        <div class="flex items-center justify-between text-xs text-slate-400 mb-2">
            <span class="font-bold text-primary">Step 2 of 4 â€” Lifestyle Factors</span>
            <span>50%</span>
        </div>
        <div class="flex gap-2">
            <div class="flex-1 h-2 rounded-full bg-primary"></div>
            <div class="flex-1 h-2 rounded-full bg-primary"></div>
            <div class="flex-1 h-2 rounded-full bg-slate-200 dark:bg-slate-700"></div>
            <div class="flex-1 h-2 rounded-full bg-slate-200 dark:bg-slate-700"></div>
        </div>
    </div>

    <!-- Form -->
    <main class="flex-1 max-w-2xl mx-auto w-full px-4 py-6 pb-28">
        <form id="step2Form" class="space-y-6 fade-in" onsubmit="return saveAndNext(event)">

            <!-- Smoking -->
            <div
                class="bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm p-5">
                <div class="flex items-center gap-2 mb-4">
                    <span class="material-symbols-outlined text-primary">smoke_free</span>
                    <h3 class="text-lg font-bold">Smoking Status *</h3>
                </div>
                <div class="grid gap-2">
                    <label
                        class="flex items-center gap-3 p-3 rounded-lg border border-slate-200 dark:border-slate-700 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50 transition">
                        <input class="h-5 w-5 text-primary focus:ring-primary" name="smoking" type="radio"
                            value="Never smoked" required />
                        <span class="text-sm font-medium">Never smoked</span>
                    </label>
                    <label
                        class="flex items-center gap-3 p-3 rounded-lg border border-slate-200 dark:border-slate-700 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50 transition">
                        <input class="h-5 w-5 text-primary focus:ring-primary" name="smoking" type="radio"
                            value="Former smoker" />
                        <span class="text-sm font-medium">Former smoker</span>
                    </label>
                    <label
                        class="flex items-center gap-3 p-3 rounded-lg border border-slate-200 dark:border-slate-700 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50 transition">
                        <input class="h-5 w-5 text-primary focus:ring-primary" name="smoking" type="radio"
                            value="Occasional smoker" />
                        <span class="text-sm font-medium">Occasional smoker</span>
                    </label>
                    <label
                        class="flex items-center gap-3 p-3 rounded-lg border border-slate-200 dark:border-slate-700 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50 transition">
                        <input class="h-5 w-5 text-primary focus:ring-primary" name="smoking" type="radio"
                            value="Daily smoker" />
                        <span class="text-sm font-medium">Daily smoker</span>
                    </label>
                </div>
            </div>

            <!-- Alcohol -->
            <div
                class="bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm p-5">
                <div class="flex items-center gap-2 mb-4">
                    <span class="material-symbols-outlined text-primary">local_bar</span>
                    <h3 class="text-lg font-bold">Alcohol Consumption</h3>
                </div>
                <div class="flex justify-between items-center mb-3">
                    <p class="text-sm text-slate-500 dark:text-slate-400">Standard drinks per week</p>
                    <span id="alcoholVal" class="text-2xl font-bold text-primary">0</span>
                </div>
                <input id="alcohol"
                    class="w-full h-2 bg-slate-200 dark:bg-slate-700 rounded-lg appearance-none cursor-pointer" min="0"
                    max="21" step="1" type="range" value="0"
                    oninput="document.getElementById('alcoholVal').textContent=this.value" />
                <div class="flex justify-between mt-1 text-xs text-slate-400">
                    <span>0</span><span>7</span><span>14</span><span>21+</span></div>
            </div>

            <!-- Exercise -->
            <div
                class="bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm p-5">
                <div class="flex items-center gap-2 mb-4">
                    <span class="material-symbols-outlined text-primary">fitness_center</span>
                    <h3 class="text-lg font-bold">Exercise Frequency</h3>
                </div>
                <select id="exercise" required
                    class="w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 px-4 py-3 focus:ring-2 focus:ring-primary outline-none transition">
                    <option value="">Select frequency</option>
                    <option value="Rarely (0-1 days/week)">Rarely (0-1 days/week)</option>
                    <option value="Moderate (2-3 days/week)">Moderate (2-3 days/week)</option>
                    <option value="Active (4-5 days/week)">Active (4-5 days/week)</option>
                    <option value="Very Active (6-7 days/week)">Very Active (6-7 days/week)</option>
                </select>
            </div>

            <!-- Diet -->
            <div
                class="bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm p-5">
                <div class="flex items-center gap-2 mb-4">
                    <span class="material-symbols-outlined text-primary">restaurant_menu</span>
                    <h3 class="text-lg font-bold">Diet Type *</h3>
                </div>
                <div class="grid grid-cols-3 gap-2">
                    <label
                        class="flex flex-col items-center gap-1 p-3 rounded-lg border border-slate-200 dark:border-slate-700 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50 transition text-center">
                        <input class="h-5 w-5 text-primary focus:ring-primary" name="diet" type="radio"
                            value="Vegetarian" required />
                        <span class="text-xs font-medium">Vegetarian</span>
                    </label>
                    <label
                        class="flex flex-col items-center gap-1 p-3 rounded-lg border border-slate-200 dark:border-slate-700 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50 transition text-center">
                        <input class="h-5 w-5 text-primary focus:ring-primary" name="diet" type="radio"
                            value="Non-vegetarian" />
                        <span class="text-xs font-medium">Non-veg</span>
                    </label>
                    <label
                        class="flex flex-col items-center gap-1 p-3 rounded-lg border border-slate-200 dark:border-slate-700 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50 transition text-center">
                        <input class="h-5 w-5 text-primary focus:ring-primary" name="diet" type="radio" value="Vegan" />
                        <span class="text-xs font-medium">Vegan</span>
                    </label>
                </div>
            </div>

            <!-- Sleep, Stress, Water -->
            <div
                class="bg-white dark:bg-slate-900 rounded-xl border border-slate-200 dark:border-slate-800 shadow-sm p-5 space-y-5">
                <div class="flex items-center gap-2 mb-2">
                    <span class="material-symbols-outlined text-primary">bedtime</span>
                    <h3 class="text-lg font-bold">Other Factors</h3>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-1.5">Sleep
                            hrs/night *</label>
                        <input id="sleep" required min="0" max="24" step="0.5"
                            class="w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 px-4 py-3 focus:ring-2 focus:ring-primary outline-none transition"
                            placeholder="7" type="number" />
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-1.5">Stress
                            Level *</label>
                        <select id="stress" required
                            class="w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 px-4 py-3 focus:ring-2 focus:ring-primary outline-none transition">
                            <option value="">Select</option>
                            <option value="Low">Low</option>
                            <option value="Moderate">Moderate</option>
                            <option value="High">High</option>
                            <option value="Very High">Very High</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-1.5">Water
                            (L/day) *</label>
                        <input id="water" required min="0" max="15" step="0.5"
                            class="w-full rounded-lg border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 px-4 py-3 focus:ring-2 focus:ring-primary outline-none transition"
                            placeholder="2.5" type="number" />
                    </div>
                </div>
            </div>
        </form>
    </main>

    <!-- Sticky Footer -->
    <footer
        class="fixed bottom-0 left-0 right-0 bg-white/90 dark:bg-slate-900/90 backdrop-blur-md border-t border-slate-200 dark:border-slate-800">
        <div class="max-w-2xl mx-auto p-4 flex gap-4">
            <a href="screeing step1.html"
                class="flex-1 py-3 rounded-xl border border-slate-200 dark:border-slate-700 font-semibold text-slate-600 dark:text-slate-300 text-center hover:bg-slate-50 dark:hover:bg-slate-800 transition">
                Back
            </a>
            <button onclick="document.getElementById('step2Form').requestSubmit()"
                class="flex-[2] py-3 rounded-xl bg-primary text-white font-bold shadow-lg shadow-primary/20 hover:bg-primary/90 transition flex items-center justify-center gap-2">
                Save & Continue
                <span class="material-symbols-outlined text-lg">arrow_forward</span>
            </button>
        </div>
    </footer>

    <script>
        // Pre-fill
        (function loadSaved() {
            const saved = localStorage.getItem('screening_step2');
            if (!saved) return;
            try {
                const d = JSON.parse(saved);
                // Smoking
                if (d.smoking) { const r = document.querySelector(`input[name="smoking"][value="${d.smoking}"]`); if (r) r.checked = true; }
                // Alcohol
                if (d.alcohol !== undefined) { document.getElementById('alcohol').value = d.alcohol; document.getElementById('alcoholVal').textContent = d.alcohol; }
                // Exercise
                if (d.exercise) document.getElementById('exercise').value = d.exercise;
                // Diet
                if (d.diet) { const r = document.querySelector(`input[name="diet"][value="${d.diet}"]`); if (r) r.checked = true; }
                // Others
                if (d.sleep) document.getElementById('sleep').value = d.sleep;
                if (d.stress) document.getElementById('stress').value = d.stress;
                if (d.water) document.getElementById('water').value = d.water;
            } catch (e) { }
        })();

        function saveAndNext(e) {
            e.preventDefault();
            const smokingEl = document.querySelector('input[name="smoking"]:checked');
            const dietEl = document.querySelector('input[name="diet"]:checked');
            const data = {
                smoking: smokingEl ? smokingEl.value : '',
                alcohol: document.getElementById('alcohol').value,
                exercise: document.getElementById('exercise').value,
                diet: dietEl ? dietEl.value : '',
                sleep: document.getElementById('sleep').value,
                stress: document.getElementById('stress').value,
                water: document.getElementById('water').value,
            };
            localStorage.setItem('screening_step2', JSON.stringify(data));
            window.location.href = 'symptom check list.html';
            return false;
        }
    </script>
</body>

</html>